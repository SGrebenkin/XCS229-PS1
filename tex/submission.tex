% This contents of this file will be inserted into the _Solutions version of the
% output tex document.  Here's an example:

% If assignment with subquestion (1.a) requires a written response, you will
% find the following flag within this document: <SCPD_SUBMISSION_TAG>_1a
% In this example, you would insert the LaTeX for your solution to (1.a) between
% the <SCPD_SUBMISSION_TAG>_1a flags.  If you also constrain your answer between the
% START_CODE_HERE and END_CODE_HERE flags, your LaTeX will be styled as a
% solution within the final document.

% Please do not use the '<SCPD_SUBMISSION_TAG>' character anywhere within your code.  As expected,
% that will confuse the regular expressions we use to identify your solution.
\def\assignmentnum{1 }
\def\assignmenttitle{XCS229 Problem Set \assignmentnum}
\input{macros}
\begin{document}
\pagestyle{myheadings} \markboth{}{\assignmenttitle}

% <SCPD_SUBMISSION_TAG>_entire_submission

This handout includes space for every question that requires a written response.
Please feel free to use it to handwrite your solutions (legibly, please).  If
you choose to typeset your solutions, the |README.md| for this assignment includes
instructions to regenerate this handout with your typeset \LaTeX{} solutions.
\ruleskip

\LARGE
1.a
\normalsize

% <SCPD_SUBMISSION_TAG>_1a
\begin{answer}
  % ### START CODE HERE ###
  Since
  \[
  \int\limits_{-\infty}^\infty{p(y;\eta)}{dy} = 1\newline
  \]
  then
  \[
  \frac{\partial}{\partial \eta} \int\limits_{-\infty}^\infty{p(y;\eta)} dy = \int\limits_{-\infty}^\infty \frac{\partial}{\partial \eta}{p(y;\eta)}{dy} = 0
  \]
  
  The probability mass function looks as follows:
  \[
  p(y;\eta) = b(y)e^{\eta y - a(\eta)}
  \]

  Its partial derivative with respect to $\eta$:
  \[
  \frac{\partial p(y;\eta)}{\partial \eta} = \frac{\partial}{\partial \eta} b(y) e^{\eta y - a(\eta)} = b(y)\frac{\partial}{\partial \eta} e^{\eta y - a(\eta)} = b(y) e^{\eta y - a(\eta)} (y - \frac{\partial a(\eta)}{\partial \eta} ) = p(y;\eta) (y - \frac{\partial a(\eta)}{\partial \eta} )
  \]

  Let's put it into the integral mentioned above:
  \[
  \int\limits_{-\infty}^\infty \frac{\partial}{\partial \eta}{p(y;\eta)}{dy} = \int\limits_{-\infty}^\infty{p(y;\eta) (y - \frac{\partial a(\eta)}{\partial \eta} )} dy = \int\limits_{-\infty}^\infty{p(y;\eta)} ydy - \int\limits_{-\infty}^\infty{ \frac{\partial a(\eta)}{\partial \eta}} dy
  \]

  since the first part is an expectation and $a(\eta)$ does not depend on y, then

  \[
  \int\limits_{-\infty}^\infty{p(y;\eta)} ydy - \int\limits_{-\infty}^\infty{ \frac{\partial a(\eta)}{\partial \eta}} dy = \mathbb{E} [Y;\eta] - \frac{\partial a(\eta)}{\partial \eta} = 0
  \]

  therefore
  \[
  \mathbb{E} [Y;\eta] = \frac{\partial a(\eta)}{\partial \eta}
  \]
  % ### END CODE HERE ###
\end{answer}
% <SCPD_SUBMISSION_TAG>_1a
\clearpage

\LARGE
1.b
\normalsize

% <SCPD_SUBMISSION_TAG>_1b
\begin{answer}
  % ### START CODE HERE ###
  % ### END CODE HERE ###
\end{answer}
% <SCPD_SUBMISSION_TAG>_1b
\clearpage

\LARGE
1.c
\normalsize

% <SCPD_SUBMISSION_TAG>_1c
\begin{answer}
  % ### START CODE HERE ###
  % ### END CODE HERE ###
\end{answer}
% <SCPD_SUBMISSION_TAG>_1c
\clearpage

\LARGE
2.a
\normalsize

% <SCPD_SUBMISSION_TAG>_2a
\begin{answer}
  
  \begin{align*}
      J(\theta)&=\\
      % ### START CODE HERE ###
      % ### END CODE HERE ###
  \end{align*}

  Differentiating this objective, we get:
  \begin{align*}
      \nabla_{\theta} J(\theta)&=\\
      % ### START CODE HERE ###
      % ### END CODE HERE ###
  \end{align*}
  % ### START CODE HERE ###
  % ### END CODE HERE ###
  The gradient descent update rule is
  %
  \begin{equation*}
  \theta := \theta - \lambda \nabla_{\theta} J(\theta)
  \end{equation*}
  %
  which reduces here to:
  % ### START CODE HERE ###
  % ### END CODE HERE ###
\end{answer}
% <SCPD_SUBMISSION_TAG>_2a
\clearpage

\LARGE
2.c
\normalsize

% <SCPD_SUBMISSION_TAG>_2c
\begin{answer}
  % ### START CODE HERE ###
  % ### END CODE HERE ###
\end{answer}
% <SCPD_SUBMISSION_TAG>_2c
\clearpage

\LARGE
2.e
\normalsize

% <SCPD_SUBMISSION_TAG>_2e
\begin{answer}
  % ### START CODE HERE ###
  % ### END CODE HERE ###
\end{answer}
% <SCPD_SUBMISSION_TAG>_2e
\clearpage

\LARGE
2.g
\normalsize

% <SCPD_SUBMISSION_TAG>_2g
\begin{answer}
  % ### START CODE HERE ###
  % ### END CODE HERE ###
\end{answer}
% <SCPD_SUBMISSION_TAG>_2g
\clearpage

\LARGE
3.a
\normalsize

% <SCPD_SUBMISSION_TAG>_3a
\begin{answer}
  % ### START CODE HERE ###
  % ### END CODE HERE ###
\end{answer}
% <SCPD_SUBMISSION_TAG>_3a

\LARGE
3.b
\normalsize

% <SCPD_SUBMISSION_TAG>_3b
\begin{answer}
  % ### START CODE HERE ###
  % ### END CODE HERE ###
\end{answer}
% <SCPD_SUBMISSION_TAG>_3b

\LARGE
3.c
\normalsize

% <SCPD_SUBMISSION_TAG>_3c
\begin{answer}
  % ### START CODE HERE ###
  % ### END CODE HERE ###
\end{answer}
% <SCPD_SUBMISSION_TAG>_3c

% <SCPD_SUBMISSION_TAG>_entire_submission

\end{document}